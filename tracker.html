<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Controle de Macronutrientes</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .section { margin-bottom: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 10px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    button.remover { background-color: red; color: white; border: none; padding: 4px 8px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Controle de Macronutrientes</h1>

  <div class="section">
    <h2>Cadastrar Alimento</h2>
    <input type="text" id="nome" placeholder="Nome do alimento">
    <input type="number" id="carboidratos" placeholder="Carboidratos (g)">
    <input type="number" id="proteinas" placeholder="Proteínas (g)">
    <input type="number" id="gorduras" placeholder="Gorduras (g)">
    <button onclick="cadastrarAlimento()">Cadastrar</button>
  </div>

  <div class="section">
    <h2>Adicionar à Refeição</h2>
    <select id="listaAlimentos"></select>
    <input type="number" id="quantidade" placeholder="Quantidade (g)" min="1">
    <button onclick="adicionarRefeicao()">Adicionar</button>

    <h3>Refeição do Dia</h3>
    <table>
      <thead>
        <tr>
          <th>Alimento</th>
          <th>Quantidade (g)</th>
          <th>Carboidratos (g)</th>
          <th>Proteínas (g)</th>
          <th>Gorduras (g)</th>
          <th>Calorias (kcal)</th>
          <th>Ação</th>
        </tr>
      </thead>
      <tbody id="tabelaRefeicao"></tbody>
      <tfoot>
        <tr>
          <th colspan="2">Total</th>
          <th id="totalCarbo"></th>
          <th id="totalProteina"></th>
          <th id="totalGordura"></th>
          <th id="totalCalorias"></th>
          <th></th>
        </tr>
      </tfoot>
    </table>
  </div>

  <script>
    const alimentos = [];
    const refeicao = [];

    function cadastrarAlimento() {
      const nome = document.getElementById('nome').value;
      const carboidratos = parseFloat(document.getElementById('carboidratos').value);
      const proteinas = parseFloat(document.getElementById('proteinas').value);
      const gorduras = parseFloat(document.getElementById('gorduras').value);

      if (!nome || isNaN(carboidratos) || isNaN(proteinas) || isNaN(gorduras)) {
        alert("Preencha todos os campos corretamente.");
        return;
      }

      const alimento = { nome, carboidratos, proteinas, gorduras };
      alimentos.push(alimento);
      atualizarListaAlimentos();

      document.getElementById('nome').value = '';
      document.getElementById('carboidratos').value = '';
      document.getElementById('proteinas').value = '';
      document.getElementById('gorduras').value = '';
    }

    function atualizarListaAlimentos() {
      const lista = document.getElementById('listaAlimentos');
      lista.innerHTML = '';
      alimentos.forEach((alimento, index) => {
        const option = document.createElement('option');
        option.value = index;
        option.textContent = alimento.nome;
        lista.appendChild(option);
      });
    }

    function adicionarRefeicao() {
      const index = document.getElementById('listaAlimentos').value;
      const quantidade = parseFloat(document.getElementById('quantidade').value);
      if (index === '' || isNaN(quantidade) || quantidade <= 0) {
        alert("Selecione um alimento e informe uma quantidade válida.");
        return;
      }

      const alimento = alimentos[index];
      const fator = quantidade / 100;
      const item = {
        nome: alimento.nome,
        quantidade,
        carboidratos: alimento.carboidratos * fator,
        proteinas: alimento.proteinas * fator,
        gorduras: alimento.gorduras * fator
      };
      refeicao.push(item);
      atualizarTabelaRefeicao();
      document.getElementById('quantidade').value = '';
    }

    function removerItem(index) {
      refeicao.splice(index, 1);
      atualizarTabelaRefeicao();
    }

    function atualizarTabelaRefeicao() {
      const tabela = document.getElementById('tabelaRefeicao');
      tabela.innerHTML = '';
      let totalCarbo = 0;
      let totalProteina = 0;
      let totalGordura = 0;

      refeicao.forEach((item, index) => {
        const calorias = (item.carboidratos * 4) + (item.proteinas * 4) + (item.gorduras * 9);
        totalCarbo += item.carboidratos;
        totalProteina += item.proteinas;
        totalGordura += item.gorduras;

        const row = `<tr>
          <td>${item.nome}</td>
          <td>${item.quantidade}</td>
          <td>${item.carboidratos.toFixed(2)}</td>
          <td>${item.proteinas.toFixed(2)}</td>
          <td>${item.gorduras.toFixed(2)}</td>
          <td>${calorias.toFixed(2)}</td>
          <td><button class="remover" onclick="removerItem(${index})">Remover</button></td>
        </tr>`;
        tabela.innerHTML += row;
      });

      const totalCalorias = (totalCarbo * 4) + (totalProteina * 4) + (totalGordura * 9);
      document.getElementById('totalCarbo').textContent = totalCarbo.toFixed(2);
      document.getElementById('totalProteina').textContent = totalProteina.toFixed(2);
      document.getElementById('totalGordura').textContent = totalGordura.toFixed(2);
      document.getElementById('totalCalorias').textContent = totalCalorias.toFixed(2);
    }
  </script>
</body>
</html>
